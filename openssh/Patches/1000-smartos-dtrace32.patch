From 0e3c769f70a4317bbb062993b42b46c9022fbe43 Mon Sep 17 00:00:00 2001
From: Alex Wilson <alex.wilson@joyent.com>
Date: Tue, 22 Dec 2015 14:30:19 -0800
Subject: [PATCH 34/35] SmartOS local: make dtrace lib 32-bit

---
 Makefile.in | 5 +++--
 1 file changed, 3 insertions(+), 2 deletions(-)

diff --git a/Makefile.in b/Makefile.in
index c1d2d848..80adc98f 100644
--- a/Makefile.in
+++ b/Makefile.in
@@ -29,6 +29,7 @@ SSH_KEYSIGN=$(libexecdir)/ssh-keysign
 SSH_PKCS11_HELPER=$(libexecdir)/ssh-pkcs11-helper
 SSH_SK_HELPER=$(libexecdir)/ssh-sk-helper
 ROOTDLIBDIR64=$(DESTDIR)/usr/lib/dtrace/64
+ROOTDLIBDIR=$(DESTDIR)/usr/lib/dtrace
 SMFMETHODDIR=$(DESTDIR)/lib/svc/method
 SMFNETMANIDIR=$(DESTDIR)/lib/svc/manifest/network
 PRIVSEP_PATH=@PRIVSEP_PATH@
@@ -277,7 +278,7 @@ sftp_provider.h: $(srcdir)/sftp_provider.d
 	    -o $(srcdir)/sftp_provider.h
 
 sftp_provider.o: sftp_provider.d sftp_provider.h sftp-server.o
-	/usr/sbin/dtrace -G -64 -xnolibs -s $(srcdir)/sftp_provider.d \
+	/usr/sbin/dtrace -G -xnolibs -s $(srcdir)/sftp_provider.d \
 	    sftp-server.o -o sftp_provider.o
 
 # special case for sftp-server.o, it includes sftp_provider.h
@@ -446,7 +447,7 @@ install-files:
 	$(INSTALL) -m 644 ssh-keysign.1m.out $(DESTDIR)$(mandir)/$(mansubdir)1m/ssh-keysign.1m
 	$(INSTALL) -m 644 ssh-pkcs11-helper.1m.out $(DESTDIR)$(mandir)/$(mansubdir)1m/ssh-pkcs11-helper.1m
 	$(INSTALL) -m 644 ssh-sk-helper.1m.out $(DESTDIR)$(mandir)/$(mansubdir)1m/ssh-sk-helper.1m
-	mkdir -p $(ROOTDLIBDIR64) && cp $(srcdir)/sftp64.d $(ROOTDLIBDIR64)/sftp64.d
+	mkdir -p $(ROOTDLIBDIR) && cp $(srcdir)/sftp64.d $(ROOTDLIBDIR)/sftp.d
 	$(srcdir)/mkinstalldirs $(SMFMETHODDIR)
 	$(srcdir)/mkinstalldirs $(SMFNETMANIDIR)
 	$(INSTALL) -m 555 smf/method.sh $(SMFMETHODDIR)/sshd
-- 
2.34.1

