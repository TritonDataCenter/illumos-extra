From e78666fd9b27e88864bd849e34de15dc948e9677 Mon Sep 17 00:00:00 2001
From: oracle <solaris@oracle.com>
Date: Mon, 3 Aug 2015 14:34:55 -0700
Subject: [PATCH 04/34] Reorganise man pages into Illumos numbering, adjust
 text

---
 Makefile.in                                 |  25 ++---
 contrib/ssh-copy-id.1                       |   4 +-
 moduli.5 => moduli.4                        |  14 +--
 scp.1                                       |  10 +-
 sftp-server.8 => sftp-server.1m             |  12 +--
 sftp.1                                      |  30 ++++--
 ssh-add.1                                   |   4 +-
 ssh-agent.1                                 |  10 +-
 ssh-keygen.1                                |  28 +++---
 ssh-keyscan.1                               |   8 +-
 ssh-keysign.8 => ssh-keysign.1m             |   8 +-
 ssh-pkcs11-helper.8 => ssh-pkcs11-helper.1m |   2 +-
 ssh-sk-helper.8 => ssh-sk-helper.1m         |   2 +-
 ssh.1                                       |  72 ++++++++------
 ssh_config.5 => ssh_config.4                |  24 ++---
 sshd.8 => sshd.1m                           |  32 +++---
 sshd_config.5 => sshd_config.4              | 104 ++++++++++----------
 17 files changed, 207 insertions(+), 182 deletions(-)
 rename moduli.5 => moduli.4 (97%)
 rename sftp-server.8 => sftp-server.1m (98%)
 rename ssh-keysign.8 => ssh-keysign.1m (97%)
 rename ssh-pkcs11-helper.8 => ssh-pkcs11-helper.1m (98%)
 rename ssh-sk-helper.8 => ssh-sk-helper.1m (98%)
 rename ssh_config.5 => ssh_config.4 (99%)
 rename sshd.8 => sshd.1m (99%)
 rename sshd_config.5 => sshd_config.4 (98%)

diff --git a/Makefile.in b/Makefile.in
index 4f2c76a4..c6532844 100644
--- a/Makefile.in
+++ b/Makefile.in
@@ -153,8 +153,8 @@ SFTPSERVER_OBJS=sftp-common.o sftp-server.o sftp-server-main.o
 
 SFTP_OBJS=	sftp.o progressmeter.o $(SFTP_CLIENT_OBJS)
 
-MANPAGES	= moduli.5.out scp.1.out ssh-add.1.out ssh-agent.1.out ssh-keygen.1.out ssh-keyscan.1.out ssh.1.out sshd.8.out sftp-server.8.out sftp.1.out ssh-keysign.8.out ssh-pkcs11-helper.8.out ssh-sk-helper.8.out sshd_config.5.out ssh_config.5.out
-MANPAGES_IN	= moduli.5 scp.1 ssh-add.1 ssh-agent.1 ssh-keygen.1 ssh-keyscan.1 ssh.1 sshd.8 sftp-server.8 sftp.1 ssh-keysign.8 ssh-pkcs11-helper.8 ssh-sk-helper.8 sshd_config.5 ssh_config.5
+MANPAGES	= moduli.4.out scp.1.out ssh-add.1.out ssh-agent.1.out ssh-keygen.1.out ssh-keyscan.1.out ssh.1.out sshd.1m.out sftp-server.1m.out sftp.1.out ssh-keysign.1m.out ssh-pkcs11-helper.1m.out ssh-sk-helper.1m.out sshd_config.4.out ssh_config.4.out
+MANPAGES_IN	= moduli.4 scp.1 ssh-add.1 ssh-agent.1 ssh-keygen.1 ssh-keyscan.1 ssh.1 sshd.1m sftp-server.1m sftp.1 ssh-keysign.1m ssh-pkcs11-helper.1m sshd_config.4 ssh_config.4
 MANTYPE		= @MANTYPE@
 
 CONFIGFILES=sshd_config.out ssh_config.out moduli.out
@@ -396,9 +396,10 @@ check-config:
 install-files:
 	$(MKDIR_P) $(DESTDIR)$(bindir)
 	$(MKDIR_P) $(DESTDIR)$(sbindir)
+	$(MKDIR_P) $(DESTDIR)$(mandir)
 	$(MKDIR_P) $(DESTDIR)$(mandir)/$(mansubdir)1
-	$(MKDIR_P) $(DESTDIR)$(mandir)/$(mansubdir)5
-	$(MKDIR_P) $(DESTDIR)$(mandir)/$(mansubdir)8
+	$(MKDIR_P) $(DESTDIR)$(mandir)/$(mansubdir)4
+	$(MKDIR_P) $(DESTDIR)$(mandir)/$(mansubdir)1m
 	$(MKDIR_P) $(DESTDIR)$(libexecdir)
 	$(MKDIR_P) -m 0755 $(DESTDIR)$(PRIVSEP_PATH)
 	$(INSTALL) -m 0755 $(STRIP_OPT) ssh$(EXEEXT) $(DESTDIR)$(bindir)/ssh$(EXEEXT)
@@ -419,15 +420,15 @@ install-files:
 	$(INSTALL) -m 644 ssh-agent.1.out $(DESTDIR)$(mandir)/$(mansubdir)1/ssh-agent.1
 	$(INSTALL) -m 644 ssh-keygen.1.out $(DESTDIR)$(mandir)/$(mansubdir)1/ssh-keygen.1
 	$(INSTALL) -m 644 ssh-keyscan.1.out $(DESTDIR)$(mandir)/$(mansubdir)1/ssh-keyscan.1
-	$(INSTALL) -m 644 moduli.5.out $(DESTDIR)$(mandir)/$(mansubdir)5/moduli.5
-	$(INSTALL) -m 644 sshd_config.5.out $(DESTDIR)$(mandir)/$(mansubdir)5/sshd_config.5
-	$(INSTALL) -m 644 ssh_config.5.out $(DESTDIR)$(mandir)/$(mansubdir)5/ssh_config.5
-	$(INSTALL) -m 644 sshd.8.out $(DESTDIR)$(mandir)/$(mansubdir)8/sshd.8
+	$(INSTALL) -m 644 moduli.4.out $(DESTDIR)$(mandir)/$(mansubdir)4/moduli.4
+	$(INSTALL) -m 644 sshd_config.4.out $(DESTDIR)$(mandir)/$(mansubdir)4/sshd_config.4
+	$(INSTALL) -m 644 ssh_config.4.out $(DESTDIR)$(mandir)/$(mansubdir)4/ssh_config.4
+	$(INSTALL) -m 644 sshd.1m.out $(DESTDIR)$(mandir)/$(mansubdir)1m/sshd.1m
 	$(INSTALL) -m 644 sftp.1.out $(DESTDIR)$(mandir)/$(mansubdir)1/sftp.1
-	$(INSTALL) -m 644 sftp-server.8.out $(DESTDIR)$(mandir)/$(mansubdir)8/sftp-server.8
-	$(INSTALL) -m 644 ssh-keysign.8.out $(DESTDIR)$(mandir)/$(mansubdir)8/ssh-keysign.8
-	$(INSTALL) -m 644 ssh-pkcs11-helper.8.out $(DESTDIR)$(mandir)/$(mansubdir)8/ssh-pkcs11-helper.8
-	$(INSTALL) -m 644 ssh-sk-helper.8.out $(DESTDIR)$(mandir)/$(mansubdir)8/ssh-sk-helper.8
+	$(INSTALL) -m 644 sftp-server.1m.out $(DESTDIR)$(mandir)/$(mansubdir)1m/sftp-server.1m
+	$(INSTALL) -m 644 ssh-keysign.1m.out $(DESTDIR)$(mandir)/$(mansubdir)1m/ssh-keysign.1m
+	$(INSTALL) -m 644 ssh-pkcs11-helper.1m.out $(DESTDIR)$(mandir)/$(mansubdir)1m/ssh-pkcs11-helper.1m
+	$(INSTALL) -m 644 ssh-sk-helper.1m.out $(DESTDIR)$(mandir)/$(mansubdir)1m/ssh-sk-helper.1m
 
 install-sysconf:
 	$(MKDIR_P) $(DESTDIR)$(sysconfdir)
diff --git a/contrib/ssh-copy-id.1 b/contrib/ssh-copy-id.1
index c141a296..0306c032 100644
--- a/contrib/ssh-copy-id.1
+++ b/contrib/ssh-copy-id.1
@@ -102,7 +102,7 @@ options, respectively.
 Rather than specifying these as command line options, it is often better to use (per-host) settings in
 .Xr ssh 1 Ns 's
 configuration file:
-.Xr ssh_config 5 .
+.Xr ssh_config 4 .
 .El
 .Pp
 Default behaviour without
@@ -195,4 +195,4 @@ option, rather than
 .Sh "SEE ALSO"
 .Xr ssh 1 ,
 .Xr ssh-agent 1 ,
-.Xr sshd 8
+.Xr sshd 1M
diff --git a/moduli.5 b/moduli.4
similarity index 97%
rename from moduli.5
rename to moduli.4
index ef0de085..f87556be 100644
--- a/moduli.5
+++ b/moduli.4
@@ -14,7 +14,7 @@
 .\" ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 .\" OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 .Dd $Mdocdate: September 26 2012 $
-.Dt MODULI 5
+.Dt MODULI 4
 .Os
 .Sh NAME
 .Nm moduli
@@ -23,7 +23,7 @@
 The
 .Pa /etc/moduli
 file contains prime numbers and generators for use by
-.Xr sshd 8
+.Xr sshd 1M
 in the Diffie-Hellman Group Exchange key exchange method.
 .Pp
 New moduli may be generated with
@@ -40,7 +40,7 @@ pass, using
 .Ic ssh-keygen -T ,
 provides a high degree of assurance that the numbers are prime and are
 safe for use in Diffie-Hellman operations by
-.Xr sshd 8 .
+.Xr sshd 1M .
 This
 .Nm
 format is used as the output from each pass.
@@ -70,7 +70,7 @@ are Sophie Germain primes (type 4).
 Further primality testing with
 .Xr ssh-keygen 1
 produces safe prime moduli (type 2) that are ready for use in
-.Xr sshd 8 .
+.Xr sshd 1M .
 Other types are not used by OpenSSH.
 .It tests
 Decimal number indicating the type of primality tests that the number
@@ -105,16 +105,16 @@ The modulus itself in hexadecimal.
 .El
 .Pp
 When performing Diffie-Hellman Group Exchange,
-.Xr sshd 8
+.Xr sshd 1M
 first estimates the size of the modulus required to produce enough
 Diffie-Hellman output to sufficiently key the selected symmetric cipher.
-.Xr sshd 8
+.Xr sshd 1M
 then randomly selects a modulus from
 .Fa /etc/moduli
 that best meets the size requirement.
 .Sh SEE ALSO
 .Xr ssh-keygen 1 ,
-.Xr sshd 8
+.Xr sshd 1M
 .Sh STANDARDS
 .Rs
 .%A M. Friedl
diff --git a/scp.1 b/scp.1
index 10cd4efb..68ea163a 100644
--- a/scp.1
+++ b/scp.1
@@ -152,13 +152,13 @@ This mode is the default.
 Can be used to pass options to
 .Nm ssh
 in the format used in
-.Xr ssh_config 5 .
+.Xr ssh_config 4 .
 This is useful for specifying options
 for which there is no separate
 .Nm scp
 command-line flag.
 For full details of the options listed below, and their possible values, see
-.Xr ssh_config 5 .
+.Xr ssh_config 4 .
 .Pp
 .Bl -tag -width Ds -offset indent -compact
 .It AddressFamily
@@ -287,9 +287,9 @@ debugging connection, authentication, and configuration problems.
 .Xr ssh-add 1 ,
 .Xr ssh-agent 1 ,
 .Xr ssh-keygen 1 ,
-.Xr ssh_config 5 ,
-.Xr sftp-server 8 ,
-.Xr sshd 8
+.Xr ssh_config 4 ,
+.Xr sftp-server 1M ,
+.Xr sshd 1M
 .Sh HISTORY
 .Nm
 is based on the rcp program in
diff --git a/sftp-server.8 b/sftp-server.1m
similarity index 98%
rename from sftp-server.8
rename to sftp-server.1m
index 5311bf92..2bac0cd3 100644
--- a/sftp-server.8
+++ b/sftp-server.1m
@@ -23,7 +23,7 @@
 .\" THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 .\"
 .Dd $Mdocdate: July 27 2021 $
-.Dt SFTP-SERVER 8
+.Dt SFTP-SERVER 1M
 .Os
 .Sh NAME
 .Nm sftp-server
@@ -47,7 +47,7 @@ is a program that speaks the server side of SFTP protocol
 to stdout and expects client requests from stdin.
 .Nm
 is not intended to be called directly, but from
-.Xr sshd 8
+.Xr sshd 1M
 using the
 .Cm Subsystem
 option.
@@ -58,7 +58,7 @@ should be specified in the
 .Cm Subsystem
 declaration.
 See
-.Xr sshd_config 5
+.Xr sshd_config 4
 for more information.
 .Pp
 Valid options are:
@@ -71,7 +71,7 @@ The pathname may contain the following tokens that are expanded at runtime:
 and %u is replaced by the username of that user.
 The default is to use the user's home directory.
 This option is useful in conjunction with the
-.Xr sshd_config 5
+.Xr sshd_config 4
 .Cm ChrootDirectory
 option.
 .It Fl e
@@ -152,8 +152,8 @@ establish a logging socket inside the chroot directory.
 .Sh SEE ALSO
 .Xr sftp 1 ,
 .Xr ssh 1 ,
-.Xr sshd_config 5 ,
-.Xr sshd 8
+.Xr sshd_config 4 ,
+.Xr sshd 1M
 .Rs
 .%A T. Ylonen
 .%A S. Lehtinen
diff --git a/sftp.1 b/sftp.1
index 7eebeeac..5e842102 100644
--- a/sftp.1
+++ b/sftp.1
@@ -90,6 +90,16 @@ An optional trailing slash can be used to force the
 .Ar path
 to be interpreted as a directory.
 .Pp
+The final usage format allows for automated sessions using the
+.Fl b
+option.
+In such cases, it is necessary to configure non-interactive authentication
+to obviate the need to enter a password at connection time (see
+.Xr sshd 1M
+and
+.Xr ssh-keygen 1
+for details).
+.Pp
 Since the destination formats use colon characters to delimit host
 names from path names or port numbers, IPv6 addresses must be
 enclosed in square brackets to avoid ambiguity.
@@ -129,7 +139,7 @@ instead of
 Since it lacks user interaction it should be used in conjunction with
 non-interactive authentication to obviate the need to enter a password
 at connection time (see
-.Xr sshd 8
+.Xr sshd 1M
 and
 .Xr ssh-keygen 1
 for details).
@@ -210,7 +220,7 @@ flag.
 Can be used to pass options to
 .Nm ssh
 in the format used in
-.Xr ssh_config 5 .
+.Xr ssh_config 4 .
 This is useful for specifying options
 for which there is no separate
 .Nm sftp
@@ -218,7 +228,7 @@ command-line flag.
 For example, to specify an alternate port use:
 .Ic sftp -oPort=24 .
 For full details of the options listed below, and their possible values, see
-.Xr ssh_config 5 .
+.Xr ssh_config 4 .
 .Pp
 .Bl -tag -width Ds -offset indent -compact
 .It AddressFamily
@@ -311,8 +321,10 @@ options.
 .It Fl s Ar subsystem | sftp_server
 Specifies the SSH2 subsystem or the path for an sftp server
 on the remote host.
-A path is useful when the remote
-.Xr sshd 8
+A path is useful for using
+.Nm
+over protocol version 1, or when the remote
+.Xr sshd 1M
 does not have an sftp subsystem configured.
 .It Fl v
 Raise logging level.
@@ -685,10 +697,10 @@ Synonym for help.
 .Xr ssh 1 ,
 .Xr ssh-add 1 ,
 .Xr ssh-keygen 1 ,
-.Xr ssh_config 5 ,
-.Xr glob 7 ,
-.Xr sftp-server 8 ,
-.Xr sshd 8
+.Xr glob 3 ,
+.Xr ssh_config 4 ,
+.Xr sftp-server 1M ,
+.Xr sshd 1M
 .Rs
 .%A T. Ylonen
 .%A S. Lehtinen
diff --git a/ssh-add.1 b/ssh-add.1
index 2786df51..7eec1053 100644
--- a/ssh-add.1
+++ b/ssh-add.1
@@ -156,7 +156,7 @@ files are usable by performing sign and verify operations on each.
 Set a maximum lifetime when adding identities to an agent.
 The lifetime may be specified in seconds or in a time format
 specified in
-.Xr sshd_config 5 .
+.Xr sshd_config 4 .
 .It Fl v
 Verbose mode.
 Causes
@@ -250,7 +250,7 @@ is unable to contact the authentication agent.
 .Xr ssh-agent 1 ,
 .Xr ssh-askpass 1 ,
 .Xr ssh-keygen 1 ,
-.Xr sshd 8
+.Xr sshd 1M
 .Sh AUTHORS
 OpenSSH is a derivative of the original and free
 ssh 1.2.12 release by Tatu Ylonen.
diff --git a/ssh-agent.1 b/ssh-agent.1
index ed8c8709..e70427c2 100644
--- a/ssh-agent.1
+++ b/ssh-agent.1
@@ -112,7 +112,7 @@ options to
 .Xr ssh-add 1 .
 Libraries that do not match the pattern list will be refused.
 See PATTERNS in
-.Xr ssh_config 5
+.Xr ssh_config 4
 for a description of pattern-list syntax.
 The default list is
 .Dq /usr/lib/*,/usr/local/lib/* .
@@ -125,7 +125,7 @@ does not look like it's a csh style of shell.
 .It Fl t Ar life
 Set a default value for the maximum lifetime of identities added to the agent.
 The lifetime may be specified in seconds or in a time format specified in
-.Xr sshd_config 5 .
+.Xr sshd_config 4 .
 A lifetime specified for an identity with
 .Xr ssh-add 1
 overrides this value.
@@ -168,7 +168,7 @@ or by
 when
 .Cm AddKeysToAgent
 is set in
-.Xr ssh_config 5 .
+.Xr ssh_config 4 .
 Multiple identities may be stored in
 .Nm
 concurrently and
@@ -219,8 +219,8 @@ The sockets should get automatically removed when the agent exits.
 .Xr ssh 1 ,
 .Xr ssh-add 1 ,
 .Xr ssh-keygen 1 ,
-.Xr ssh_config 5 ,
-.Xr sshd 8
+.Xr ssh_config 4 ,
+.Xr sshd 1M
 .Sh AUTHORS
 .An -nosplit
 OpenSSH is a derivative of the original and free ssh 1.2.12 release by
diff --git a/ssh-keygen.1 b/ssh-keygen.1
index f83f515f..fba02c73 100644
--- a/ssh-keygen.1
+++ b/ssh-keygen.1
@@ -207,9 +207,7 @@ key in
 .Pa ~/.ssh/id_ed25519_sk
 or
 .Pa ~/.ssh/id_rsa .
-Additionally, the system administrator may use this to generate host keys,
-as seen in
-.Pa /etc/rc .
+Additionally, the system administrator may use this to generate host keys.
 .Pp
 Normally this program generates the key and asks for a file in which
 to store the private key.
@@ -275,7 +273,7 @@ If
 has also been specified, its argument is used as a prefix to the
 default path for the resulting host key files.
 This is used by
-.Pa /etc/rc
+.Pa /lib/svc/method/sshd
 to generate new host keys.
 .It Fl a Ar rounds
 When saving a private key, this option specifies the number of KDF
@@ -506,7 +504,7 @@ device to use, rather than letting the token middleware select one.
 Indicate that the generated private key should not require touch
 events (user presence) when making signatures.
 Note that
-.Xr sshd 8
+.Xr sshd 1M
 will refuse such signatures by default, unless overridden via
 an authorized_keys option.
 .It Cm resident
@@ -639,7 +637,7 @@ a date in YYYYMMDD format, a time in YYYYMMDDHHMM[SS] format,
 a relative time (to the current time) consisting of a minus sign followed by
 an interval in the format described in the
 TIME FORMATS section of
-.Xr sshd_config 5 .
+.Xr sshd_config 4 .
 .Pp
 The end time may be specified as a YYYYMMDD date, a YYYYMMDDHHMM[SS] time,
 a relative time starting with a plus character or the string
@@ -969,7 +967,7 @@ Disable PTY allocation (permitted by default).
 Disable execution of
 .Pa ~/.ssh/rc
 by
-.Xr sshd 8
+.Xr sshd 1M
 (permitted by default).
 .Pp
 .It Ic no-x11-forwarding
@@ -990,7 +988,7 @@ Allows PTY allocation.
 Allows execution of
 .Pa ~/.ssh/rc
 by
-.Xr sshd 8 .
+.Xr sshd 1M .
 .Pp
 .It Ic permit-X11-forwarding
 Allows X11 forwarding.
@@ -1035,7 +1033,7 @@ Epoch to the distant future.
 .Pp
 For certificates to be used for user or host authentication, the CA
 public key must be trusted by
-.Xr sshd 8
+.Xr sshd 1M
 or
 .Xr ssh 1 .
 Please refer to those manual pages for details.
@@ -1093,7 +1091,7 @@ KRLs that revoke keys by SHA256 hash are not supported by OpenSSH versions
 prior to 7.9.
 .It Cm hash : Ar fingerprint
 Revokes a key using a fingerprint hash, as obtained from a
-.Xr sshd 8
+.Xr sshd 1M
 authentication log message or the
 .Nm
 .Fl l
@@ -1126,7 +1124,7 @@ uses a simple list of identities and keys to determine whether a signature
 comes from an authorized source.
 This "allowed signers" file uses a format patterned after the
 AUTHORIZED_KEYS FILE FORMAT described in
-.Xr sshd 8 .
+.Xr sshd 1M .
 Each line of the file contains the following space-separated fields:
 principals, options, keytype, base64-encoded key.
 Empty lines and lines starting with a
@@ -1134,7 +1132,7 @@ Empty lines and lines starting with a
 are ignored as comments.
 .Pp
 The principals field is a pattern-list (see PATTERNS in
-.Xr ssh_config 5 )
+.Xr ssh_config 4 )
 consisting of one or more comma-separated USER@DOMAIN identity patterns
 that are accepted for signing.
 When verifying, the identity presented via the
@@ -1219,14 +1217,14 @@ There is no need to keep the contents of this file secret.
 .It Pa /etc/moduli
 Contains Diffie-Hellman groups used for DH-GEX.
 The file format is described in
-.Xr moduli 5 .
+.Xr moduli 4 .
 .El
 .Sh SEE ALSO
 .Xr ssh 1 ,
 .Xr ssh-add 1 ,
 .Xr ssh-agent 1 ,
-.Xr moduli 5 ,
-.Xr sshd 8
+.Xr moduli 4 ,
+.Xr sshd 1M
 .Rs
 .%R RFC 4716
 .%T "The Secure Shell (SSH) Public Key File Format"
diff --git a/ssh-keyscan.1 b/ssh-keyscan.1
index f9df75d4..05ad81af 100644
--- a/ssh-keyscan.1
+++ b/ssh-keyscan.1
@@ -28,7 +28,7 @@ It was designed to aid in building and verifying
 .Pa ssh_known_hosts
 files,
 the format of which is documented in
-.Xr sshd 8 .
+.Xr sshd 1M .
 .Nm
 provides a minimal interface suitable for use by shell and perl
 scripts.
@@ -39,7 +39,7 @@ parallel, so it is very efficient.
 The keys from a domain of 1,000
 hosts can be collected in tens of seconds, even when some of those
 hosts are down or do not run
-.Xr sshd 8 .
+.Xr sshd 1M .
 For scanning, one does not need
 login access to the machines that are being scanned, nor does the
 scanning process involve any encryption.
@@ -82,7 +82,7 @@ Hash all hostnames and addresses in the output.
 Hashed names may be used normally by
 .Xr ssh 1
 and
-.Xr sshd 8 ,
+.Xr sshd 1M ,
 but they do not reveal identifying information should the file's contents
 be disclosed.
 .It Fl p Ar port
@@ -144,7 +144,7 @@ $ ssh-keyscan -t rsa,dsa,ecdsa,ed25519 -f ssh_hosts | \e
 .Ed
 .Sh SEE ALSO
 .Xr ssh 1 ,
-.Xr sshd 8
+.Xr sshd 1M
 .Rs
 .%D 2006
 .%R RFC 4255
diff --git a/ssh-keysign.8 b/ssh-keysign.1m
similarity index 97%
rename from ssh-keysign.8
rename to ssh-keysign.1m
index 73b62397..cb9baaa1 100644
--- a/ssh-keysign.8
+++ b/ssh-keysign.1m
@@ -23,7 +23,7 @@
 .\" THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 .\"
 .Dd $Mdocdate: November 30 2019 $
-.Dt SSH-KEYSIGN 8
+.Dt SSH-KEYSIGN 1M
 .Os
 .Sh NAME
 .Nm ssh-keysign
@@ -52,7 +52,7 @@ is not intended to be invoked by the user, but from
 See
 .Xr ssh 1
 and
-.Xr sshd 8
+.Xr sshd 1M
 for more information about host-based authentication.
 .Sh FILES
 .Bl -tag -width Ds -compact
@@ -83,8 +83,8 @@ information corresponding with the private keys above.
 .Sh SEE ALSO
 .Xr ssh 1 ,
 .Xr ssh-keygen 1 ,
-.Xr ssh_config 5 ,
-.Xr sshd 8
+.Xr ssh_config 4 ,
+.Xr sshd 1M
 .Sh HISTORY
 .Nm
 first appeared in
diff --git a/ssh-pkcs11-helper.8 b/ssh-pkcs11-helper.1m
similarity index 98%
rename from ssh-pkcs11-helper.8
rename to ssh-pkcs11-helper.1m
index 6a592b1f..bf6a52e0 100644
--- a/ssh-pkcs11-helper.8
+++ b/ssh-pkcs11-helper.1m
@@ -15,7 +15,7 @@
 .\" OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 .\"
 .Dd $Mdocdate: November 30 2019 $
-.Dt SSH-PKCS11-HELPER 8
+.Dt SSH-PKCS11-HELPER 1M
 .Os
 .Sh NAME
 .Nm ssh-pkcs11-helper
diff --git a/ssh-sk-helper.8 b/ssh-sk-helper.1m
similarity index 98%
rename from ssh-sk-helper.8
rename to ssh-sk-helper.1m
index 3c53da1e..8d820a2f 100644
--- a/ssh-sk-helper.8
+++ b/ssh-sk-helper.1m
@@ -15,7 +15,7 @@
 .\" OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 .\"
 .Dd $Mdocdate: December 21 2019 $
-.Dt SSH-SK-HELPER 8
+.Dt SSH-SK-HELPER 1m
 .Os
 .Sh NAME
 .Nm ssh-sk-helper
diff --git a/ssh.1 b/ssh.1
index 7efb2382..24ee6822 100644
--- a/ssh.1
+++ b/ssh.1
@@ -169,7 +169,7 @@ listed in order of preference.
 See the
 .Cm Ciphers
 keyword in
-.Xr ssh_config 5
+.Xr ssh_config 4
 for more information.
 .Pp
 .It Fl D Xo
@@ -426,7 +426,7 @@ before each operation that changes the multiplexing state
 Refer to the description of
 .Cm ControlMaster
 in
-.Xr ssh_config 5
+.Xr ssh_config 4
 for details.
 .Pp
 .It Fl m Ar mac_spec
@@ -495,7 +495,7 @@ Can be used to give options in the format used in the configuration file.
 This is useful for specifying options for which there is no separate
 command-line flag.
 For full details of the options listed below, and their possible values, see
-.Xr ssh_config 5 .
+.Xr ssh_config 4 .
 .Pp
 .Bl -tag -width Ds -offset indent -compact
 .It AddKeysToAgent
@@ -620,9 +620,9 @@ flag),
 .Ar sig
 (supported signature algorithms).
 Alternatively, any keyword from
-.Xr ssh_config 5
+.Xr ssh_config 4
 or
-.Xr sshd_config 5
+.Xr sshd_config 4
 that takes an algorithm list may be used as an alias for the corresponding
 query_option.
 .Pp
@@ -696,7 +696,7 @@ Specifying a remote
 will only succeed if the server's
 .Cm GatewayPorts
 option is enabled (see
-.Xr sshd_config 5 ) .
+.Xr sshd_config 4 ) .
 .Pp
 If the
 .Ar port
@@ -718,7 +718,7 @@ Refer to the description of
 and
 .Cm ControlMaster
 in
-.Xr ssh_config 5
+.Xr ssh_config 4
 for details.
 .Pp
 .It Fl s
@@ -802,7 +802,7 @@ See also the
 and
 .Cm TunnelDevice
 directives in
-.Xr ssh_config 5 .
+.Xr ssh_config 4 .
 .Pp
 If the
 .Cm Tunnel
@@ -831,7 +831,7 @@ Please refer to the
 option and the
 .Cm ForwardX11Trusted
 directive in
-.Xr ssh_config 5
+.Xr ssh_config 4
 for more information.
 .Pp
 .It Fl x
@@ -853,9 +853,23 @@ By default this information is sent to stderr.
 may additionally obtain configuration data from
 a per-user configuration file and a system-wide configuration file.
 The file format and configuration options are described in
-.Xr ssh_config 5 .
+.Xr ssh_config 4 .
 .Sh AUTHENTICATION
-The OpenSSH SSH client supports SSH protocol 2.
+The OpenSSH SSH client supports SSH protocols 1 and 2.
+The default is to use protocol 2 only,
+though this can be changed via the
+.Cm Protocol
+option in
+.Xr ssh_config 4
+or the
+.Fl 1
+and
+.Fl 2
+options (see above).
+Protocol 1 should not be used
+and is only offered to support legacy devices.
+It suffers from a number of cryptographic weaknesses
+and doesn't support many of the advanced features available for protocol 2.
 .Pp
 The methods available for authentication are:
 GSSAPI-based authentication,
@@ -996,7 +1010,7 @@ See
 and (optionally) the
 .Cm AddKeysToAgent
 directive in
-.Xr ssh_config 5
+.Xr ssh_config 4
 for more information.
 .Pp
 Keyboard-interactive authentication works as follows:
@@ -1128,7 +1142,7 @@ for dynamic port-forwardings.
 allows the user to execute a local command if the
 .Ic PermitLocalCommand
 option is enabled in
-.Xr ssh_config 5 .
+.Xr ssh_config 4 .
 Basic help is available, using the
 .Fl h
 option.
@@ -1316,7 +1330,7 @@ Are you sure you want to continue connecting (yes/no)?
 See the
 .Cm VerifyHostKeyDNS
 option in
-.Xr ssh_config 5
+.Xr ssh_config 4
 for more information.
 .Sh SSH-BASED VIRTUAL PRIVATE NETWORKS
 .Nm
@@ -1326,7 +1340,7 @@ using the
 network pseudo-device,
 allowing two networks to be joined securely.
 The
-.Xr sshd_config 5
+.Xr sshd_config 4
 configuration option
 .Cm PermitTunnel
 controls whether the server supports this,
@@ -1478,12 +1492,12 @@ If the current session has no tty,
 this variable is not set.
 .It Ev SSH_TUNNEL
 Optionally set by
-.Xr sshd 8
+.Xr sshd 1M
 to contain the interface names assigned if tunnel forwarding was
 requested by the client.
 .It Ev SSH_USER_AUTH
 Optionally set by
-.Xr sshd 8 ,
+.Xr sshd 1M ,
 this variable may contain a pathname to a file that lists the authentication
 methods successfully used when the session was established, including any
 public keys that were used.
@@ -1506,7 +1520,7 @@ change their environment.
 For more information, see the
 .Cm PermitUserEnvironment
 option in
-.Xr sshd_config 5 .
+.Xr sshd_config 4 .
 .Sh FILES
 .Bl -tag -width Ds -compact
 .It Pa ~/.rhosts
@@ -1514,7 +1528,7 @@ This file is used for host-based authentication (see above).
 On some machines this file may need to be
 world-readable if the user's home directory is on an NFS partition,
 because
-.Xr sshd 8
+.Xr sshd 1M
 reads it as root.
 Additionally, this file must be owned by the user,
 and must not have write permissions for anyone else.
@@ -1539,7 +1553,7 @@ and not accessible by others.
 Lists the public keys (DSA, ECDSA, Ed25519, RSA)
 that can be used for logging in as this user.
 The format of this file is described in the
-.Xr sshd 8
+.Xr sshd 1M
 manual page.
 This file is not highly sensitive, but the recommended
 permissions are read/write for the user, and not accessible by others.
@@ -1547,7 +1561,7 @@ permissions are read/write for the user, and not accessible by others.
 .It Pa ~/.ssh/config
 This is the per-user configuration file.
 The file format and configuration options are described in
-.Xr ssh_config 5 .
+.Xr ssh_config 4 .
 Because of the potential for abuse, this file must have strict permissions:
 read/write for the user, and not writable by others.
 .Pp
@@ -1586,7 +1600,7 @@ sensitive and can (but need not) be readable by anyone.
 Contains a list of host keys for all hosts the user has logged into
 that are not already in the systemwide list of known host keys.
 See
-.Xr sshd 8
+.Xr sshd 1M
 for further details of the format of this file.
 .Pp
 .It Pa ~/.ssh/rc
@@ -1595,7 +1609,7 @@ Commands in this file are executed by
 when the user logs in, just before the user's shell (or command) is
 started.
 See the
-.Xr sshd 8
+.Xr sshd 1M
 manual page for more information.
 .Pp
 .It Pa /etc/hosts.equiv
@@ -1611,7 +1625,7 @@ rlogin/rsh.
 .It Pa /etc/ssh/ssh_config
 Systemwide configuration file.
 The file format and configuration options are described in
-.Xr ssh_config 5 .
+.Xr ssh_config 4 .
 .Pp
 .It Pa /etc/ssh/ssh_host_key
 .It Pa /etc/ssh/ssh_host_dsa_key
@@ -1628,7 +1642,7 @@ system administrator to contain the public host keys of all machines in the
 organization.
 It should be world-readable.
 See
-.Xr sshd 8
+.Xr sshd 1M
 for further details of the format of this file.
 .Pp
 .It Pa /etc/ssh/sshrc
@@ -1636,7 +1650,7 @@ Commands in this file are executed by
 .Nm
 when the user logs in, just before the user's shell (or command) is started.
 See the
-.Xr sshd 8
+.Xr sshd 1M
 manual page for more information.
 .El
 .Sh EXIT STATUS
@@ -1651,9 +1665,9 @@ if an error occurred.
 .Xr ssh-keygen 1 ,
 .Xr ssh-keyscan 1 ,
 .Xr tun 4 ,
-.Xr ssh_config 5 ,
-.Xr ssh-keysign 8 ,
-.Xr sshd 8
+.Xr ssh_config 4 ,
+.Xr ssh-keysign 1M ,
+.Xr sshd 1M
 .Sh STANDARDS
 .Rs
 .%A S. Lehtinen
diff --git a/ssh_config.5 b/ssh_config.4
similarity index 99%
rename from ssh_config.5
rename to ssh_config.4
index 170125a0..a0db5bc5 100644
--- a/ssh_config.5
+++ b/ssh_config.4
@@ -35,7 +35,7 @@
 .\"
 .\" $OpenBSD: ssh_config.5,v 1.366 2021/09/25 09:40:33 kn Exp $
 .Dd $Mdocdate: September 25 2021 $
-.Dt SSH_CONFIG 5
+.Dt SSH_CONFIG 4
 .Os
 .Sh NAME
 .Nm ssh_config
@@ -249,7 +249,7 @@ Alternately, this option may be specified as a time interval
 using the format described in the
 .Sx TIME FORMATS
 section of
-.Xr sshd_config 5
+.Xr sshd_config 4
 to specify the key's lifetime in
 .Xr ssh-agent 1 ,
 after which it will automatically be removed.
@@ -607,7 +607,7 @@ then the master connection will remain in the background indefinitely
 (until killed or closed via a mechanism such as the
 .Qq ssh -O exit ) .
 If set to a time in seconds, or a time in any of the formats documented in
-.Xr sshd_config 5 ,
+.Xr sshd_config 4 ,
 then the backgrounded master connection will automatically terminate
 after it has remained idle (with no client connections) for the
 specified time.
@@ -649,7 +649,7 @@ Setting this option to
 in the global client configuration file
 .Pa /etc/ssh/ssh_config
 enables the use of the helper program
-.Xr ssh-keysign 8
+.Xr ssh-keysign 1M
 during
 .Cm HostbasedAuthentication .
 The argument must be
@@ -659,7 +659,7 @@ or
 (the default).
 This option should be placed in the non-hostspecific section.
 See
-.Xr ssh-keysign 8
+.Xr ssh-keysign 1M
 for more information.
 .It Cm EscapeChar
 Sets the escape character (default:
@@ -779,7 +779,7 @@ Specify a timeout for untrusted X11 forwarding
 using the format described in the
 .Sx TIME FORMATS
 section of
-.Xr sshd_config 5 .
+.Xr sshd_config 4 .
 X11 connections received by
 .Xr ssh 1
 after this time will be refused.
@@ -845,7 +845,7 @@ should hash host names and addresses when they are added to
 These hashed names may be used normally by
 .Xr ssh 1
 and
-.Xr sshd 8 ,
+.Xr sshd 1M ,
 but they do not visually reveal identifying information if the
 file's contents are disclosed.
 The default is
@@ -1418,7 +1418,7 @@ section.
 The command can be basically anything,
 and should read from its standard input and write to its standard output.
 It should eventually connect an
-.Xr sshd 8
+.Xr sshd 1M
 server running on some machine, or execute
 .Ic sshd -i
 somewhere.
@@ -1540,7 +1540,7 @@ and
 depending on the cipher.
 The optional second value is specified in seconds and may use any of the
 units documented in the TIME FORMATS section of
-.Xr sshd_config 5 .
+.Xr sshd_config 4 .
 The default value for
 .Cm RekeyLimit
 is
@@ -1608,7 +1608,7 @@ Specifying a remote
 will only succeed if the server's
 .Cm GatewayPorts
 option is enabled (see
-.Xr sshd_config 5 ) .
+.Xr sshd_config 4 ) .
 .It Cm RequestTTY
 Specifies whether to request a pseudo-tty for the session.
 The argument may be one of:
@@ -1658,7 +1658,7 @@ pseudo-terminal is requested as it is required by the protocol.
 Refer to
 .Cm AcceptEnv
 in
-.Xr sshd_config 5
+.Xr sshd_config 4
 for how to configure the server.
 Variables are specified by name, which may contain wildcard characters.
 Multiple environment variables may be separated by whitespace or spread
@@ -1918,7 +1918,7 @@ Confirmation is currently incompatible with
 and will be disabled if it is enabled.
 .Pp
 Presently, only
-.Xr sshd 8
+.Xr sshd 1M
 from OpenSSH 6.8 and greater support the
 .Qq hostkeys@openssh.com
 protocol extension used to inform the client of all the server's hostkeys.
diff --git a/sshd.8 b/sshd.1m
similarity index 99%
rename from sshd.8
rename to sshd.1m
index ef38949a..897de1e0 100644
--- a/sshd.8
+++ b/sshd.1m
@@ -35,7 +35,7 @@
 .\"
 .\" $OpenBSD: sshd.8,v 1.317 2021/09/10 11:38:38 dtucker Exp $
 .Dd $Mdocdate: September 10 2021 $
-.Dt SSHD 8
+.Dt SSHD 1M
 .Os
 .Sh NAME
 .Nm sshd
@@ -63,8 +63,8 @@ over an insecure network.
 .Pp
 .Nm
 listens for connections from clients.
-It is normally started at boot from
-.Pa /etc/rc .
+It is normally started at boot by
+.Xr smf 5 .
 It forks a new
 daemon for each incoming connection.
 The forked daemons handle
@@ -74,7 +74,7 @@ and data exchange.
 .Nm
 can be configured using command-line options or a configuration file
 (by default
-.Xr sshd_config 5 ) ;
+.Xr sshd_config 4 ) ;
 command-line options override values specified in the
 configuration file.
 .Nm
@@ -183,7 +183,7 @@ Can be used to give options in the format used in the configuration file.
 This is useful for specifying options for which there is no separate
 command-line flag.
 For full details of the options, and their values, see
-.Xr sshd_config 5 .
+.Xr sshd_config 4 .
 .It Fl p Ar port
 Specifies the port on which the server listens for connections
 (default 22).
@@ -349,14 +349,14 @@ if it exists, and users are allowed to change their environment.
 See the
 .Cm PermitUserEnvironment
 option in
-.Xr sshd_config 5 .
+.Xr sshd_config 4 .
 .It
 Changes to user's home directory.
 .It
 If
 .Pa ~/.ssh/rc
 exists and the
-.Xr sshd_config 5
+.Xr sshd_config 4
 .Cm PermitUserRC
 option is set, runs it; else if
 .Pa /etc/ssh/sshrc
@@ -514,7 +514,7 @@ The command originally supplied by the client is available in the
 environment variable.
 Note that this option applies to shell, command or subsystem execution.
 Also note that this command may be superseded by a
-.Xr sshd_config 5
+.Xr sshd_config 4
 .Cm ForceCommand
 directive.
 .Pp
@@ -540,7 +540,7 @@ Specifies that in addition to public key authentication, either the canonical
 name of the remote host or its IP address must be present in the
 comma-separated list of patterns.
 See PATTERNS in
-.Xr ssh_config 5
+.Xr ssh_config 4
 for more information on patterns.
 .Pp
 In addition to the wildcard matching that may be applied to hostnames or
@@ -582,7 +582,7 @@ Multiple
 .Cm permitlisten
 options may be applied separated by commas.
 Hostnames may include wildcards as described in the PATTERNS section in
-.Xr ssh_config 5 .
+.Xr ssh_config 4 .
 A port specification of
 .Cm *
 matches any port.
@@ -917,7 +917,7 @@ It should only be writable by root.
 Contains Diffie-Hellman groups used for the "Diffie-Hellman Group Exchange"
 key exchange method.
 The file format is described in
-.Xr moduli 5 .
+.Xr moduli 4 .
 If no usable groups are found in this file then fixed internal groups will
 be used.
 .Pp
@@ -976,7 +976,7 @@ should be world-readable.
 Contains configuration data for
 .Nm sshd .
 The file format and configuration options are described in
-.Xr sshd_config 5 .
+.Xr sshd_config 4 .
 .Pp
 .It Pa /etc/ssh/sshrc
 Similar to
@@ -1011,10 +1011,10 @@ The content of this file is not sensitive; it can be world-readable.
 .Xr ssh-keyscan 1 ,
 .Xr chroot 2 ,
 .Xr login.conf 5 ,
-.Xr moduli 5 ,
-.Xr sshd_config 5 ,
-.Xr inetd 8 ,
-.Xr sftp-server 8
+.Xr moduli 4 ,
+.Xr sshd_config 4 ,
+.Xr inetd 1M ,
+.Xr sftp-server 1M
 .Sh AUTHORS
 OpenSSH is a derivative of the original and free
 ssh 1.2.12 release by Tatu Ylonen.
diff --git a/sshd_config.5 b/sshd_config.4
similarity index 98%
rename from sshd_config.5
rename to sshd_config.4
index dfd3fba4..e8011df9 100644
--- a/sshd_config.5
+++ b/sshd_config.4
@@ -35,13 +35,13 @@
 .\"
 .\" $OpenBSD: sshd_config.5,v 1.335 2021/09/03 05:25:50 dtucker Exp $
 .Dd $Mdocdate: September 3 2021 $
-.Dt SSHD_CONFIG 5
+.Dt SSHD_CONFIG 4
 .Os
 .Sh NAME
 .Nm sshd_config
 .Nd OpenSSH daemon configuration file
 .Sh DESCRIPTION
-.Xr sshd 8
+.Xr sshd 1M
 reads configuration data from
 .Pa /etc/ssh/sshd_config
 (or the file specified with
@@ -69,7 +69,7 @@ See
 and
 .Cm SetEnv
 in
-.Xr ssh_config 5
+.Xr ssh_config 4
 for how to configure the client.
 The
 .Ev TERM
@@ -89,7 +89,7 @@ For this reason, care should be taken in the use of this directive.
 The default is not to accept any environment variables.
 .It Cm AddressFamily
 Specifies which address family should be used by
-.Xr sshd 8 .
+.Xr sshd 1M .
 Valid arguments are
 .Cm any
 (the default),
@@ -118,7 +118,7 @@ The allow/deny groups directives are processed in the following order:
 .Cm AllowGroups .
 .Pp
 See PATTERNS in
-.Xr ssh_config 5
+.Xr ssh_config 4
 for more information on patterns.
 .It Cm AllowStreamLocalForwarding
 Specifies whether StreamLocal (Unix-domain socket) forwarding is permitted.
@@ -175,7 +175,7 @@ The allow/deny users directives are processed in the following order:
 .Cm AllowUsers .
 .Pp
 See PATTERNS in
-.Xr ssh_config 5
+.Xr ssh_config 4
 for more information on patterns.
 .It Cm AuthenticationMethods
 Specifies the authentication methods that must be successfully completed
@@ -210,7 +210,7 @@ would restrict keyboard interactive authentication to the
 device.
 .Pp
 If the publickey method is listed more than once,
-.Xr sshd 8
+.Xr sshd 1M
 verifies that keys that have been used successfully are not reused for
 subsequent authentications.
 For example,
@@ -246,7 +246,7 @@ The program should produce on standard output zero or
 more lines of authorized_keys output (see
 .Sx AUTHORIZED_KEYS
 in
-.Xr sshd 8 ) .
+.Xr sshd 1M ) .
 .Cm AuthorizedKeysCommand
 is tried after the usual
 .Cm AuthorizedKeysFile
@@ -265,12 +265,12 @@ If
 is specified but
 .Cm AuthorizedKeysCommandUser
 is not, then
-.Xr sshd 8
+.Xr sshd 1M
 will refuse to start.
 .It Cm AuthorizedKeysFile
 Specifies the file that contains the public keys used for user authentication.
 The format is described in the AUTHORIZED_KEYS FILE FORMAT section of
-.Xr sshd 8 .
+.Xr sshd 1M .
 Arguments to
 .Cm AuthorizedKeysFile
 accept the tokens described in the
@@ -323,7 +323,7 @@ If
 is specified but
 .Cm AuthorizedPrincipalsCommandUser
 is not, then
-.Xr sshd 8
+.Xr sshd 1M
 will refuse to start.
 .It Cm AuthorizedPrincipalsFile
 Specifies a file that lists principal names that are accepted for
@@ -335,7 +335,7 @@ to be accepted for authentication.
 Names are listed one per line preceded by key options (as described in
 .Sx AUTHORIZED_KEYS FILE FORMAT
 in
-.Xr sshd 8 ) .
+.Xr sshd 1M ) .
 Empty lines and comments starting with
 .Ql #
 are ignored.
@@ -363,7 +363,7 @@ and is not consulted for certification authorities trusted via
 though the
 .Cm principals=
 key option offers a similar facility (see
-.Xr sshd 8
+.Xr sshd 1M
 for details).
 .It Cm Banner
 The contents of the specified file are sent to the remote user before
@@ -400,11 +400,11 @@ Specifies the pathname of a directory to
 .Xr chroot 2
 to after authentication.
 At session startup
-.Xr sshd 8
+.Xr sshd 1M
 checks that all components of the pathname are root-owned directories
 which are not writable by any other user or group.
 After the chroot,
-.Xr sshd 8
+.Xr sshd 1M
 changes the working directory to the user's home directory.
 Arguments to
 .Cm ChrootDirectory
@@ -435,14 +435,14 @@ sftp-server is used,
 though sessions which use logging may require
 .Pa /dev/log
 inside the chroot directory on some operating systems (see
-.Xr sftp-server 8
+.Xr sftp-server 1M
 for details).
 .Pp
 For safety, it is very important that the directory hierarchy be
 prevented from modification by other processes on the system (especially
 those outside the jail).
 Misconfiguration can lead to unsafe environments which
-.Xr sshd 8
+.Xr sshd 1M
 cannot detect.
 .Pp
 The default is
@@ -501,7 +501,7 @@ The list of available ciphers may also be obtained using
 .Qq ssh -Q cipher .
 .It Cm ClientAliveCountMax
 Sets the number of client alive messages which may be sent without
-.Xr sshd 8
+.Xr sshd 1M
 receiving any messages back from the client.
 If this threshold is reached while client alive messages are being sent,
 sshd will disconnect the client, terminating the session.
@@ -529,7 +529,7 @@ disables connection termination.
 .It Cm ClientAliveInterval
 Sets a timeout interval in seconds after which if no data has been received
 from the client,
-.Xr sshd 8
+.Xr sshd 1M
 will send a message through the encrypted
 channel to request a response from the client.
 The default
@@ -558,7 +558,7 @@ The allow/deny groups directives are processed in the following order:
 .Cm AllowGroups .
 .Pp
 See PATTERNS in
-.Xr ssh_config 5
+.Xr ssh_config 4
 for more information on patterns.
 .It Cm DenyUsers
 This keyword can be followed by a list of user name patterns, separated
@@ -576,7 +576,7 @@ The allow/deny users directives are processed in the following order:
 .Cm AllowUsers .
 .Pp
 See PATTERNS in
-.Xr ssh_config 5
+.Xr ssh_config 4
 for more information on patterns.
 .It Cm DisableForwarding
 Disables all forwarding features, including X11,
@@ -625,7 +625,7 @@ The default is
 Specifies whether remote hosts are allowed to connect to ports
 forwarded for the client.
 By default,
-.Xr sshd 8
+.Xr sshd 1M
 binds remote port forwardings to the loopback address.
 This prevents other remote hosts from connecting to forwarded ports.
 .Cm GatewayPorts
@@ -718,7 +718,7 @@ files during
 A setting of
 .Cm yes
 means that
-.Xr sshd 8
+.Xr sshd 1M
 uses the name supplied by the client rather than
 attempting to resolve the name from the TCP connection itself.
 The default is
@@ -729,7 +729,7 @@ The certificate's public key must match a private host key already specified
 by
 .Cm HostKey .
 The default behaviour of
-.Xr sshd 8
+.Xr sshd 1M
 is not to load any certificates.
 .It Cm HostKey
 Specifies a file containing a private host key
@@ -741,12 +741,12 @@ and
 .Pa /etc/ssh/ssh_host_rsa_key .
 .Pp
 Note that
-.Xr sshd 8
+.Xr sshd 1M
 will refuse to use a file if it is group/world-accessible
 and that the
 .Cm HostKeyAlgorithms
 option restricts which of the keys are actually used by
-.Xr sshd 8 .
+.Xr sshd 1M .
 .Pp
 It is possible to have multiple host key files.
 It is also possible to specify public host key files instead.
@@ -813,7 +813,7 @@ and
 .Pa rhosts .
 .It Cm IgnoreUserKnownHosts
 Specifies whether
-.Xr sshd 8
+.Xr sshd 1M
 should ignore the user's
 .Pa ~/.ssh/known_hosts
 during
@@ -974,7 +974,7 @@ The list of available key exchange algorithms may also be obtained using
 .Qq ssh -Q KexAlgorithms .
 .It Cm ListenAddress
 Specifies the local addresses
-.Xr sshd 8
+.Xr sshd 1M
 should listen on.
 The following forms may be used:
 .Pp
@@ -1008,7 +1008,7 @@ The following forms may be used:
 The optional
 .Cm rdomain
 qualifier requests
-.Xr sshd 8
+.Xr sshd 1M
 listen in an explicit routing domain.
 If
 .Ar port
@@ -1030,7 +1030,7 @@ If the value is 0, there is no time limit.
 The default is 120 seconds.
 .It Cm LogLevel
 Gives the verbosity level that is used when logging messages from
-.Xr sshd 8 .
+.Xr sshd 1M .
 The possible values are:
 QUIET, FATAL, ERROR, INFO, VERBOSE, DEBUG, DEBUG1, DEBUG2, and DEBUG3.
 The default is INFO.
@@ -1160,7 +1160,7 @@ The match patterns may consist of single entries or comma-separated
 lists and may use the wildcard and negation operators described in the
 .Sx PATTERNS
 section of
-.Xr ssh_config 5 .
+.Xr ssh_config 4 .
 .Pp
 The patterns in an
 .Cm Address
@@ -1259,14 +1259,14 @@ The default is 10:30:100.
 Alternatively, random early drop can be enabled by specifying
 the three colon separated values
 start:rate:full (e.g. "10:30:60").
-.Xr sshd 8
+.Xr sshd 1M
 will refuse connection attempts with a probability of rate/100 (30%)
 if there are currently start (10) unauthenticated connections.
 The probability increases linearly and all connection attempts
 are refused if the number of unauthenticated connections reaches full (60).
 .It Cm ModuliFile
 Specifies the
-.Xr moduli 5
+.Xr moduli 4
 file that contains the Diffie-Hellman groups used for the
 .Dq diffie-hellman-group-exchange-sha1
 and
@@ -1308,7 +1308,7 @@ An argument of
 .Cm none
 can be used to prohibit all listen requests.
 The host name may contain wildcards as described in the PATTERNS section in
-.Xr ssh_config 5 .
+.Xr ssh_config 4 .
 The wildcard
 .Sq *
 can also be used in place of a port number to allow all ports.
@@ -1428,7 +1428,7 @@ and
 options in
 .Pa ~/.ssh/authorized_keys
 are processed by
-.Xr sshd 8 .
+.Xr sshd 1m .
 Valid options are
 .Cm yes ,
 .Cm no
@@ -1472,7 +1472,7 @@ The default is
 .Pa /var/run/sshd.pid .
 .It Cm Port
 Specifies the port number that
-.Xr sshd 8
+.Xr sshd 1M
 listens on.
 The default is 22.
 Multiple options of this type are permitted.
@@ -1480,14 +1480,14 @@ See also
 .Cm ListenAddress .
 .It Cm PrintLastLog
 Specifies whether
-.Xr sshd 8
+.Xr sshd 1M
 should print the date and time of the last user login when a user logs
 in interactively.
 On Solaris this option is always ignored since pam_unix_session(5)
 reports the last login time.
 .It Cm PrintMotd
 Specifies whether
-.Xr sshd 8
+.Xr sshd 1M
 should print
 .Pa /etc/motd
 when a user logs in interactively.
@@ -1550,7 +1550,7 @@ or
 to always require the signature to attest that a physically present user
 explicitly confirmed the authentication (usually by touching the authenticator).
 By default,
-.Xr sshd 8
+.Xr sshd 1M
 requires user presence unless overridden with an authorized_keys option.
 The
 .Cm touch-required
@@ -1623,7 +1623,7 @@ the built-in USB HID support.
 .It Cm SetEnv
 Specifies one or more environment variables to set in child sessions started
 by
-.Xr sshd 8
+.Xr sshd 1M
 as
 .Dq NAME=VALUE .
 The environment value may be quoted (e.g. if it contains whitespace
@@ -1664,7 +1664,7 @@ The default is
 .Cm no .
 .It Cm StrictModes
 Specifies whether
-.Xr sshd 8
+.Xr sshd 1M
 should check file modes and ownership of the
 user's files and home directory before accepting login.
 This is normally desirable because novices sometimes accidentally leave their
@@ -1693,7 +1693,7 @@ to force a different filesystem root on clients.
 By default no subsystems are defined.
 .It Cm SyslogFacility
 Gives the facility code that is used when logging messages from
-.Xr sshd 8 .
+.Xr sshd 1M .
 The possible values are: DAEMON, USER, AUTH, LOCAL0, LOCAL1, LOCAL2,
 LOCAL3, LOCAL4, LOCAL5, LOCAL6, LOCAL7.
 The default is AUTH.
@@ -1736,7 +1736,7 @@ For more details on certificates, see the CERTIFICATES section in
 .Xr ssh-keygen 1 .
 .It Cm UseDNS
 Specifies whether
-.Xr sshd 8
+.Xr sshd 1M
 should look up the remote host name, and to check that
 the resolved host name for the remote IP address maps back to the
 very same IP address.
@@ -1771,7 +1771,7 @@ or
 If
 .Cm UsePAM
 is enabled, you will not be able to run
-.Xr sshd 8
+.Xr sshd 1M
 as a non-root user.
 The default is
 .Cm no .
@@ -1782,7 +1782,7 @@ The default is
 .Cm none .
 .It Cm X11DisplayOffset
 Specifies the first display number available for
-.Xr sshd 8 Ns 's
+.Xr sshd 1M Ns 's
 X11 forwarding.
 This prevents sshd from interfering with real X11 servers.
 The default is 10.
@@ -1797,7 +1797,7 @@ The default is
 .Pp
 When X11 forwarding is enabled, there may be additional exposure to
 the server and to client displays if the
-.Xr sshd 8
+.Xr sshd 1M
 proxy display is configured to listen on the wildcard address (see
 .Cm X11UseLocalhost ) ,
 though this is not the default.
@@ -1808,7 +1808,7 @@ display server may be exposed to attack when the SSH client requests
 forwarding (see the warnings for
 .Cm ForwardX11
 in
-.Xr ssh_config 5 ) .
+.Xr ssh_config 4 ) .
 A system administrator may have a stance in which they want to
 protect clients that may expose themselves to attack by unwittingly
 requesting X11 forwarding, which can warrant a
@@ -1819,7 +1819,7 @@ Note that disabling X11 forwarding does not prevent users from
 forwarding X11 traffic, as users can always install their own forwarders.
 .It Cm X11UseLocalhost
 Specifies whether
-.Xr sshd 8
+.Xr sshd 1M
 should bind the X11 forwarding server to the loopback address or to
 the wildcard address.
 By default,
@@ -1852,7 +1852,7 @@ The default is
 .Pa /usr/X11R6/bin/xauth .
 .El
 .Sh TIME FORMATS
-.Xr sshd 8
+.Xr sshd 1M
 command-line arguments and configuration file options that specify time
 may be expressed using a sequence of the form:
 .Sm off
@@ -1947,13 +1947,13 @@ accepts the token %D.
 .Bl -tag -width Ds
 .It Pa /etc/ssh/sshd_config
 Contains configuration data for
-.Xr sshd 8 .
+.Xr sshd 1M .
 This file should be writable by root only, but it is recommended
 (though not necessary) that it be world-readable.
 .El
 .Sh SEE ALSO
-.Xr sftp-server 8 ,
-.Xr sshd 8 ,
+.Xr sftp-server 1M ,
+.Xr sshd 1M ,
 .Xr pam_unix_session 5
 .Sh AUTHORS
 .An -nosplit
-- 
2.30.1 (Apple Git-130)

